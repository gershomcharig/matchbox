# Matchbox Development Progress

This file tracks accomplishments, failures, and learnings across execution loops.
Read this file at the start of each session to maintain context and avoid repeating mistakes.

---

## Current Status
**Last Updated**: 2026-01-21
**Current Phase**: Phase 1 Complete, Ready for Phase 2
**Next Step**: Phase 2.1 - Password Setup Screen

---

## Completed Tasks

### Phase 0: Project Setup (COMPLETE)
- [x] 0.1 Initialize Next.js with App Router (commit: 1b205b7)
- [x] 0.2 Tailwind CSS configured and tested
- [x] 0.3 Environment & Git setup (.env.local.example created)
- [x] 0.4 Project structure created (components/, lib/, app/)
- [x] 0.5 Supabase client setup (lib/supabase.ts) (commit: 05922ea)
- [x] 0.6-0.9 Database schema created:
  - settings table (key, value)
  - collections table (id, name, color, icon, timestamps)
  - places table (all fields per schema)
  - tags table (id, name)
  - place_tags junction table (place_id, tag_id)

### Phase 1: Map Foundation (COMPLETE)
- [x] 1.1 Mapbox Setup - installed mapbox-gl@3.18.0 and react-map-gl@8.1.0
- [x] 1.2 Basic Map component - components/Map.tsx, centered on London (51.5074, -0.1278)
- [x] 1.3 Map styling - using mapbox://styles/mapbox/light-v11, fills viewport
- [x] 1.4 Responsive layout shell - components/Layout.tsx with flex layout
- [x] 1.5 Empty state overlay - components/EmptyState.tsx with prompt message

---

## Decisions Made

### Database
- Using Supabase (PostgreSQL) with free tier
- All tables created via Supabase dashboard/SQL editor
- Foreign key from places.collection_id â†’ collections.id
- Soft delete via deleted_at timestamp on places

### Project Structure
- /src/app - Next.js App Router pages
- /src/components - React components
- /src/lib - Utility functions (supabase.ts, etc.)
- /docs - Documentation (roadmap.md, PRD.md, progress.txt)

### Map Implementation
- Using react-map-gl v8 with subpath import: `react-map-gl/mapbox`
- Map style: mapbox://styles/mapbox/light-v11 (clean, minimal)
- Initial zoom level: 11

### UI/Design
- Minimal, clean aesthetic
- Empty state overlay positioned at bottom center
- Glass-morphism style card (bg-white/95 with backdrop-blur)
- Responsive breakpoint at lg (1024px) for desktop side panel

---

## Blockers Encountered

### 2026-01-21 - react-map-gl import issue with Turbopack
**Problem**: Build failed with "Module not found: Can't resolve 'react-map-gl'"
**Why it failed**: react-map-gl v8 uses subpath exports, no default export
**Solution**: Changed import from `react-map-gl` to `react-map-gl/mapbox`

---

## Failed Approaches

### 2026-01-21 - Default react-map-gl import
**Problem**: `import MapGL from 'react-map-gl'` failed in Turbopack
**Why it failed**: react-map-gl v8 restructured exports to use subpaths
**Better approach**: Use `import { Map } from 'react-map-gl/mapbox'` for Mapbox GL

---

## Files Changed Log

### 2026-01-21
- Created: docs/progress.txt
- Modified: CLAUDE.md (added progress tracking instructions)
- Modified: package.json (added mapbox-gl, react-map-gl)
- Created: src/components/Map.tsx
- Created: src/components/Layout.tsx
- Created: src/components/EmptyState.tsx
- Modified: src/app/page.tsx (uses Layout, Map, EmptyState)
- Modified: src/app/layout.tsx (updated title and description)

---

## Learnings

### react-map-gl v8 Breaking Changes
- v8 uses ES module subpath exports
- Import from `react-map-gl/mapbox` for Mapbox GL JS
- Import from `react-map-gl/maplibre` for MapLibre GL JS
- The Map component is named export, not default: `{ Map }`

### Next.js 16 with Turbopack
- Turbopack has stricter module resolution than Webpack
- Some npm packages may need specific import paths
- Build errors often more informative than dev server errors

---

## Next Steps (from roadmap.md)

1. Phase 2.1: Create /setup page with password form
2. Phase 2.2: Implement password hashing
3. Phase 2.3: Store password hash in settings table
4. Phase 2.4: Create /login page
5. Phase 2.5: Password verification logic

Reference: docs/roadmap.md for full task breakdown
